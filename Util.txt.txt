Utility functions v2 and v1
